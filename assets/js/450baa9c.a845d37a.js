"use strict";(self.webpackChunktalon_wiki=self.webpackChunktalon_wiki||[]).push([[7202],{4823:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"Customization/misc-tips","title":"Tips and tricks","description":"This section contains some additional miscellaneous information which may be useful for developing and debugging Talon scripts.","source":"@site/docs/Customization/misc-tips.md","sourceDirName":"Customization","slug":"/Customization/misc-tips","permalink":"/Customization/misc-tips","draft":false,"unlisted":false,"editUrl":"https://github.com/TalonCommunity/Wiki/edit/main/docs/Customization/misc-tips.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"CustomizationSidebar","previous":{"title":"key() action","permalink":"/Customization/Talon Library Reference/key_action"},"next":{"title":"Display an Image on Screen","permalink":"/Customization/Examples/canvas"}}');var t=i(4848),s=i(8453);const a={sidebar_position:10},r="Tips and tricks",l={},c=[{value:"REPL and logging",id:"repl-and-logging",level:2},{value:"Introspection functions",id:"introspection-functions",level:2},{value:"API functions",id:"api-functions",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"tips-and-tricks",children:"Tips and tricks"})}),"\n",(0,t.jsx)(n.p,{children:"This section contains some additional miscellaneous information which may be useful for developing and debugging Talon scripts."}),"\n",(0,t.jsx)(n.h2,{id:"repl-and-logging",children:"REPL and logging"}),"\n",(0,t.jsx)(n.p,{children:'Talon comes with a Python Read Eval Print Loop (REPL) which can be accessed from the Scripting menu. This lets you try out actions and use the introspection functions mentioned below. If you have the community grammars installed you can also access this by voice using "talon open rebel".'}),"\n",(0,t.jsxs)(n.p,{children:["There is also a ",(0,t.jsx)(n.code,{children:"repl"})," executable in the ",(0,t.jsx)(n.code,{children:"bin"})," subdirectory of your Talon home folder. You can pipe REPL commands into that and they will be executed in the running Talon environment. This is often used as a RPC interface to Talon. For example executing a line like this on Linux would toggle whether Talon is listening to the microphone: ",(0,t.jsx)(n.code,{children:"bash -c \"echo 'actions.speech.toggle()' | ~/.talon/bin/repl\""}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Talon also has basic logging functionality. If you have run Talon from the terminal you will have seen the output, but it can also be viewed using the 'Scripting -> View log' menu item or directly in the ",(0,t.jsx)(n.code,{children:"talon.log"})," file in your Talon home folder. To add to the log from your script simply use the Python ",(0,t.jsx)(n.code,{children:"print()"})," function, though in general this is only used for debugging."]}),"\n",(0,t.jsx)(n.h2,{id:"introspection-functions",children:"Introspection functions"}),"\n",(0,t.jsx)(n.p,{children:"This section lists some built in methods which are useful for developing or debugging Talon behaviour. The following are all imported by default into the REPL and aren't really meant to be used outside that context."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'sim("tab close")'})," - Finds the .talon file that would handle the given command in the current context. If the command is not active in the current context, then it prints an error. Useful for finding the relevant code for a voice command. You might want to paste something like ",(0,t.jsx)(n.code,{children:'import time;time.sleep(5);sim("tab close")'})," in to the REPL to give you a chance to switch to the appropriate context."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'mimic("say hello world")'})," - Executes the given voice command like you spoke it in to the microphone. Can be useful to re-run voice commands while editing them so you don't have to keep saying the same thing."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'actions.find("string")'})," - Searches the name, documentation, and code implementing an action for the given substring. Prints out a list of matches."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'actions.list("edit")'})," - Prints out all registered actions matching the given prefix. If no argument is supplied then lists all actions. See the basic customization page for a trick to copy this output into your clipboard."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"events.tail()"})," - If you're not getting enough information about what Talon is doing from the log file you can take a look at this method. It prints out Talon internal events, user actions called, scope changes etc. to the REPL. For even more logging try the ",(0,t.jsx)(n.code,{children:"events.tail(noisy=True)"})," flag. You can also print out historical events and filter the events, run ",(0,t.jsx)(n.code,{children:"help(events.tail)"})," to see the options."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"registry.commands"}),", ",(0,t.jsx)(n.code,{children:"registry.lists"})," etc. - Lets you view the currently active set of commands, lists, actions etc. that Talon is considering."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"api-functions",children:"API functions"}),"\n",(0,t.jsxs)(n.p,{children:["Talon provides an API under the ",(0,t.jsx)(n.code,{children:"talon"})," package allowing you to perform various actions from Python. Some examples are window management and drawing overlays. Talon is closed source, but does provide class, method, and module signatures as ",(0,t.jsx)(n.code,{children:".pyi"})," files in the ",(0,t.jsx)(n.code,{children:"resources/python/lib/python3.9/site-packages/talon/"})," folder. These files can also be linked to by your IDE to provide autocompletion etc. Note that many of the ",(0,t.jsx)(n.code,{children:".pyi"})," files are internally facing, but it's generally fairly clear what's intended to be stable and used by user scripts."]}),"\n",(0,t.jsx)(n.p,{children:"A quick pointer to some APIs follows:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"__init__.pyi"})," - The main API functionality is imported here (e.g. Module, Context, actions). This is what you import when you include ",(0,t.jsx)(n.code,{children:"import talon"})," in your code."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ui.pyi"})," - window and workspace management functionality and focus change events. OS specific functionality is imported at the top of the file from ",(0,t.jsx)(n.code,{children:"(linux|mac|windows)/ui.pyi"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"clip.pyi"})," - Cross platform clipboard monitoring and management."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"cron.pyi"})," - Periodic tasks, use this for polling or background tasks so as not to block the main Talon thread."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"screen.pyi"})," - Monitor/screen management querying functionality (e.g. get dimensions of screen), also screenshot functions."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"imgui.pyi"})," - A simple GUI system for drawing basic floating windows including text and buttons."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"canvas.pyi"})," - A floating canvas implementation with transparency that optionally captures mouse and keyboard events. See also the ",(0,t.jsx)(n.code,{children:"talon.skia"})," package which provides the drawing functions (based on ",(0,t.jsx)(n.a,{href:"https://skia.org/docs/",children:"the Skia library"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"noise.pyi"})," - Register for pop and hiss noise events."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"experimental/"})," - This package contains experimental APIs which may change in signature or be removed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ctrl.pyi"})," - 'Low level' mouse and keyboard event injection. You should prefer using the exposed mouse/keyboard actions rather than this."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"fs.pyi"})," - Watch files and folders for changes."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You are also able to use almost all of the CPython standard library. So you can use that do do network requests, maths operations, or execute subprocesses for example. Other Python packages like numpy may be included in the Talon distribution as an implementation detail, but are not guaranteed to be included forever."}),"\n",(0,t.jsxs)(n.p,{children:["An escape hatch for this kind of thing is the ",(0,t.jsx)(n.code,{children:".venv"})," folder in your Talon home directory. The ",(0,t.jsx)(n.code,{children:"pip"})," executable in the ",(0,t.jsx)(n.code,{children:"bin"})," subdirectory of your Talon home directory allows you to install arbitrary Python packages in to that. You're generally a bit on your own with this and may have difficulty building binary packages. For this reason it is discouraged to ask users of any public package you build to install things in their venv."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var o=i(6540);const t={},s=o.createContext(t);function a(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);